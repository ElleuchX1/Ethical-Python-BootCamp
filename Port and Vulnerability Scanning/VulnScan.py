import socket
import os
import sys
from sty import fg
#Note: The File should contain the banners in readable format, add as much as you can
#
#Exemple:
#        --------------------------------
# ------|OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 |-------
# ------|Apache httpd 2.4.29 ((Ubuntu))  |-------
# ------|MiniServ 1.910 (Webmin httpd)   |-------
#        ---------------------------------
def retrieveBanner(host,port):
    try:
        socket.setdefaulttimeout(0)
        sock=socket.socket()
        sock.connect((host,port))
        banner=sock.recv(1024)
        return banner
    except:
        return
def vulnChecker(banner,Fname):
    f = open(Fname, "r")
    for line in f.readlines():
        if line in banner:
            print('|+| System Vulnerable to: {}'.format(banner))

def main():
    if len(sys.argv) == 2:
        Fname= sys.argv[1]
        if not ( os.path.isfile(Fname) ):
            print(fg.red+'File Error... The File Does not Exit!'+fg.rs)
            exit(0)
        elif not ( os.access(Fname,os.R_OK)):
            print(fg.red+'File Error... You do not have access to this file'+fg.rs)
            exit(0)
        
        else:
            print(fg.red+'Command Error...'+str(sys.argv[0])+"<File Path>"+fg.rs)
        Plist=[21,22,80,443] # ADD HERE ANY PORT YOU WANT

        for ending in range(1,226): # CHANGE DEPENDING ON YOUR RANGE
            ip_addr="8.8.8."+str(ending)
            for port in Plist:
                banner= retrieveBanner(ip_addr,port)
                if banner:
                    print('|+| {}:{}  : {}'.format(ip_addr,port,banner))
if __name__ == "__main__":
    main()
